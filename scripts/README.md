# Rotated Ellipse Intersection

- ellipse parameters: $a$, $b$, $c_x$, $c_y$, $\theta$
- ray parameters: $p_x$, $p_y$, $v_x$, $v_y$
- $t_0 = a^2\sin^2\theta+b^2\cos^2\theta$
- $t_1 = a^2\cos^2\theta+b^2\sin^2\theta$
- $t_2 = (a^2 - b^2)\sin\theta\cos\theta$
- $t_3 = c_y t_2 - c_x t_0$
- $t_4 = c_x t_2 - c_y t_1$
- $t_5 = c_x^2 t_0 + c_y^2 t_1 - 2 c_x c_y t_2$

- Intersection

|           | $v_x^2$       | $v_x v_y$          | $v_y^2$       | $v_x$ | $v_y$ | $1$ |
|-----------|---------------|--------------------|---------------|-------|-------|-----|
| $p_x^2$   |               |                    | $-1$          |       |       |     |
| $p_x p_y$ |               | $2$                |               |       |       |     |
| $p_y^2$   | $-1$          |                    |               |       |       |     |
| $p_x$     |               | $-2c_y$            | $2c_x$        |       |       |     |
| $p_y$     | $2c_y$        | $-2c_x$            |               |       |       |     |
| $1$       | $t_0 - c_y^2$ | $-2t_2 + 2c_x c_y$ | $t_1 - c_x^2$ |       |       |     |

- Outside

|           | $v_x^2$ | $v_x v_y$ | $v_y^2$ | $v_x$ | $v_y$ | $1$                    |
|-----------|---------|-----------|---------|-------|-------|------------------------|
| $p_x^2$   |         |           |         |       |       | $\frac{t_0}{a^2b^2}$   |
| $p_x p_y$ |         |           |         |       |       | $\frac{-2t_2}{a^2b^2}$ |
| $p_y^2$   |         |           |         |       |       | $\frac{t_1}{a^2b^2}$   |
| $p_x$     |         |           |         |       |       | $\frac{2t_3}{a^2b^2}$  |
| $p_y$     |         |           |         |       |       | $\frac{2t_4}{a^2b^2}$  |
| $1$       |         |           |         |       |       | $\frac{t_5}{a^2b^2}-1$ |

- tmp0

|           | $v_x^2$ | $v_x v_y$ | $v_y^2$ | $v_x$ | $v_y$ | $1$ |
|-----------|---------|-----------|---------|-------|-------|-----|
| $p_x^2$   |         |           |         |       |       |     |
| $p_x p_y$ |         |           |         |       |       |     |
| $p_y^2$   |         |           |         |       |       |     |
| $p_x$     |         |           |         |       |       |     |
| $p_y$     |         |           |         |       |       |     |
| $1$       | $t_0$   | $-2t_2$   | $t_1$   |       |       |     |

- tmp2

|           | $v_x^2$ | $v_x v_y$ | $v_y^2$ | $v_x$                | $v_y$                | $1$ |
|-----------|---------|-----------|---------|----------------------|----------------------|-----|
| $p_x^2$   |         |           |         |                      |                      |     |
| $p_x p_y$ |         |           |         |                      |                      |     |
| $p_y^2$   |         |           |         |                      |                      |     |
| $p_x$     |         |           |         | $t_0$                | $-t_2$               |     |
| $p_y$     |         |           |         | $-t_2$               | $t_1$                |     |
| $1$       |         |           |         | $-c_x t_0 + c_y t_2$ | $-c_y t_1 + c_x t_2$ |     |
